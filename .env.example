# 分析服务环境配置文件
# 请根据实际情况修改以下配置参数

# 服务基础配置
PROJECT_NAME="N-MeekYolo Analysis Service"
VERSION="1.0.0"
API_PREFIX="/api/v1"
DEBUG_ENABLED=false
ENVIRONMENT="production"

# CORS配置
CORS_ORIGINS=["*"]
CORS_ALLOW_CREDENTIALS=true
CORS_ALLOW_METHODS=["*"]
CORS_ALLOW_HEADERS=["*"]

# 服务配置
SERVICES_HOST="0.0.0.0"
SERVICES_PORT=8002

# 通信配置
COMMUNICATION_MODE="http"

# Redis配置
REDIS_HOST="localhost"
REDIS_PORT=6379
REDIS_PASSWORD=""
REDIS_DB=0
REDIS_MAX_CONNECTIONS=50
REDIS_SOCKET_TIMEOUT=5
REDIS_RETRY_ON_TIMEOUT=true



# 分析配置
ANALYSIS_CONFIDENCE=0.2
ANALYSIS_IOU=0.45
ANALYSIS_MAX_DET=300
ANALYSIS_DEVICE="auto"
ANALYSIS_ANALYZE_INTERVAL=1
ANALYSIS_ALARM_INTERVAL=60
ANALYSIS_RANDOM_INTERVAL_MIN=0
ANALYSIS_RANDOM_INTERVAL_MAX=0
ANALYSIS_PUSH_INTERVAL=1

# 存储配置
STORAGE_BASE_DIR="data"
STORAGE_MODEL_DIR="models"
STORAGE_TEMP_DIR="temp"
STORAGE_MAX_SIZE=10737418240

# 输出配置
OUTPUT_SAVE_DIR="results"
OUTPUT_SAVE_TXT=false
OUTPUT_SAVE_IMG=true
OUTPUT_RETURN_BASE64=true

# 任务队列配置
TASK_QUEUE_MAX_CONCURRENT=30
TASK_QUEUE_MAX_RETRIES=3
TASK_QUEUE_RETRY_DELAY=5
TASK_QUEUE_RESULT_TTL=7200
TASK_QUEUE_CLEANUP_INTERVAL=3600

# Redis任务队列键配置
REDIS_TASK_QUEUE_KEY="analysis:task:queue"
REDIS_TASK_HASH_KEY="analysis:task:hash"
REDIS_TASK_RESULT_KEY="analysis:task:result"
REDIS_TASK_STATUS_KEY="analysis:task:status"
REDIS_TASK_CALLBACK_KEY="analysis:task:callback"
REDIS_TASK_EXPIRE=86400
REDIS_RESULT_EXPIRE=3600
REDIS_CALLBACK_EXPIRE=1800

# 服务发现配置
DISCOVERY_INTERVAL=30
DISCOVERY_TIMEOUT=5
DISCOVERY_RETRY=3

# Streaming配置
STREAMING_RECONNECT_ATTEMPTS=5
STREAMING_RECONNECT_DELAY=3
STREAMING_READ_TIMEOUT=15
STREAMING_CONNECT_TIMEOUT=10
STREAMING_MAX_CONSECUTIVE_ERRORS=10
STREAMING_FRAME_BUFFER_SIZE=10
STREAMING_LOG_LEVEL="INFO"
STREAMING_USE_ZLMEDIAKIT=true

# ZLMediaKit配置
ZLM_SERVER_ADDRESS="127.0.0.1"
ZLM_HTTP_PORT=8088
ZLM_RTSP_PORT=554
ZLM_RTMP_PORT=1935
ZLM_API_PORT=8088
ZLM_API_SECRET="OOEV3gbdHQh4VngpRdNcCeANzy4OFB4u"
ZLM_LIB_PATH="/usr/local/lib"
ZLM_THREAD_NUM=0
ZLM_LOG_LEVEL=1
ZLM_LOG_PATH="logs/zlm"

# 协议配置
# 通用协议配置
PROTOCOL_RETRY_COUNT=3
PROTOCOL_RETRY_INTERVAL=5000
PROTOCOL_TIMEOUT=10000

# HTTP协议配置
PROTOCOL_HTTP_USER_AGENT="Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/91.0.4472.114 Safari/537.36"
PROTOCOL_HTTP_AUTH_ENABLE=false
PROTOCOL_HTTP_AUTH_USER=""
PROTOCOL_HTTP_AUTH_PASSWORD=""
PROTOCOL_HTTP_USE_CACHE=true
PROTOCOL_HTTP_CACHE_TIMEOUT=3600

# HLS协议配置
PROTOCOL_HLS_SEGMENT_DURATION=5
PROTOCOL_HLS_PLAYLIST_SIZE=5
PROTOCOL_HLS_CACHE_SEGMENTS=true
PROTOCOL_HLS_MAX_SEGMENTS=5
PROTOCOL_HLS_USER_AGENT="Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/91.0.4472.124 Safari/537.36"

# RTMP协议配置
PROTOCOL_RTMP_PORT=1935
PROTOCOL_RTMP_SSL_PORT=19350
PROTOCOL_RTMP_AUTH_ENABLE=false
PROTOCOL_RTMP_AUTH_USER=""
PROTOCOL_RTMP_AUTH_PASSWORD=""
PROTOCOL_RTMP_MAX_BUFFER_MS=2000

# RTSP协议配置
PROTOCOL_RTSP_PORT=554
PROTOCOL_RTSP_SSL_PORT=322
PROTOCOL_RTSP_AUTH_ENABLE=false
PROTOCOL_RTSP_AUTH_USER=""
PROTOCOL_RTSP_AUTH_PASSWORD=""
PROTOCOL_RTSP_RTP_TYPE="tcp"
PROTOCOL_RTSP_MAX_BUFFER_MS=2000

# WebRTC协议配置
PROTOCOL_WEBRTC_ENABLE_AUDIO=false
PROTOCOL_WEBRTC_VIDEO_CODEC="H264"
PROTOCOL_WEBRTC_MAX_BITRATE=2000000
PROTOCOL_WEBRTC_FORCE_TCP=false
PROTOCOL_WEBRTC_LOCAL_TCP_PORT=8189
PROTOCOL_WEBRTC_USE_WHIP=false
PROTOCOL_WEBRTC_USE_WHEP=false

# ONVIF协议配置
PROTOCOL_ONVIF_AUTH_ENABLE=true
PROTOCOL_ONVIF_AUTH_USERNAME="admin"
PROTOCOL_ONVIF_AUTH_PASSWORD="admin"
PROTOCOL_ONVIF_CONNECTION_TIMEOUT=10000
PROTOCOL_ONVIF_RECEIVE_TIMEOUT=15000
PROTOCOL_ONVIF_PREFER_PROFILE_TYPE="main"
PROTOCOL_ONVIF_PREFER_H264=true
PROTOCOL_ONVIF_PREFER_TCP=true
PROTOCOL_ONVIF_BUFFER_SIZE=8

# GB28181协议配置
PROTOCOL_GB28181_SIP_PORT=5060
PROTOCOL_GB28181_DEVICE_ID="34020000002000000001"
PROTOCOL_GB28181_SERVER_ID="34020000002000000001"
PROTOCOL_GB28181_DOMAIN="3402000000"
PROTOCOL_GB28181_PASSWORD="12345678"
PROTOCOL_GB28181_PREFER_STREAM_TYPE="main"
PROTOCOL_GB28181_AUTO_SWITCH_SUB_STREAM=true
PROTOCOL_GB28181_BUFFER_SIZE=8

# 注意：请确保填写所有必要的配置参数
# 特别是Redis和ZLMediaKit的连接信息，否则服务将无法正常启动